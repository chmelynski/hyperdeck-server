
<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<title>Payment Details</title>

<!-- The required Stripe lib -->
<script type="text/javascript" src="https://js.stripe.com/v2/"></script>

<!-- jQuery is used only for this example; it isn't required to use Stripe -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script type="text/javascript">
	// This identifies your website in the createToken call below
	Stripe.setPublishableKey('pk_rYUTbjuEPvDkgrtwJB0zKGcGf0CM8');
	
	var stripeResponseHandler = function(status, response)
	{
		var $form = $('#payment-form');
		
		if (response.error)
		{
			$form.find('.payment-errors').text(response.error.message); // Show the errors on the form
			$form.find('button').prop('disabled', false);
		}
		else
		{
			var token = response.id; // token contains id, last4, and card type
			$form.append($('<input type="hidden" name="stripeToken" />').val(token)); // Insert the token into the form so it gets submitted to the server
			$form.get(0).submit(); // and re-submit
		}
	};
	
	jQuery(function($)
	{
		$('#payment-form').submit(function(e)
		{
			var $form = $(this);
			$form.find('button').prop('disabled', true); // Disable the submit button to prevent repeated clicks
			Stripe.card.createToken($form, stripeResponseHandler);
			return false; // Prevent the form from submitting with the default action
		});
	});
</script>
</head>
<body>
	<form action="/enroll?plan={{ plan }}" method="POST" id="payment-form">
	{% csrf_token %}
	
	<span class="payment-errors"></span>
	
	<div class="form-row">
		<label>
			<span>Card Number</span>
			<input type="text" size="20" data-stripe="number"/>
		</label>
	</div>
	
	<div class="form-row">
		<label>
			<span>CVC</span>
			<input type="text" size="4" data-stripe="cvc"/>
		</label>
	</div>
	
	<div class="form-row">
		<label>
			<span>Expiration (MM/YYYY)</span>
			<input type="text" size="2" data-stripe="exp-month"/>
		</label>
		<span> / </span>
		<input type="text" size="4" data-stripe="exp-year"/>
	</div>
	
	<button type="submit">Submit Payment</button>
	</form>
</body>
</html>

