{% load static from staticfiles %}
{% load pipeline %}
{% load bootstrap3 %}
<!DOCTYPE html>
<html>
<head>
  <link href="{% static 'griddl/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel='stylesheet' type='text/css' href="{% static 'griddl/css/codemirror-5.0.css' %}" />
  <link rel='stylesheet' type='text/css' href="{% static 'griddl/css/jquery.ui.css' %}" />
  <link rel='stylesheet' type='text/css' href="{% static 'griddl/css/handsontable.full-0.14.1.css' %}" />
  <link rel='stylesheet' type='text/css' href="{% static 'griddl/css/custom.css' %}" />
  <link rel='stylesheet' type='text/css' href="{% static 'griddl/css/griddl.css' %}" />

  <script type='text/javascript' src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/bootstrap.min.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/utils.js' %}"></script>

  <script type='text/javascript' src="{% static 'griddl/js/lib/codemirror-5.0.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/codemirror-5.0-javascript.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/codemirror-5.0-css.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/codemirror-5.0-xml.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/codemirror-5.0-markdown.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/jquery.mousewheel.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/handsontable.full.min-0.14.1.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/opentype.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/jquery-ui.sortable.min.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/dat.gui.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/markdown.min.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/js-yaml.min.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/jquery.csv.min.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/sjcl.js' %}"></script>

  <link rel="stylesheet" href="{% static 'griddl/js/lib/fold/foldgutter.css' %}" />
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/foldcode.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/foldgutter.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/brace-fold.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/indent-fold.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/xml-fold.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/markdown-fold.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/lib/fold/comment-fold.js' %}"></script>
  
  {% comment %}
  <script type='text/javascript' src="{% static 'griddl/js/results.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/griddl.components.new.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/griddl.componentHeaders.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/handlersGeneric.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/b64Converters.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/genericUploadDownload.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/markDirty.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/elementIds.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/export.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/import.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/components/code.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/components/data.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/components/file.js' %}"></script>
  <script type='text/javascript' src="{% static 'griddl/js/components/libraries.js' %}"></script>
  {% endcomment %}
  
  {# these are for PDF documents  #}
  {% comment %}
    <script type='text/javascript' src="{% static 'griddl/js/components/box.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/text.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/font.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/document.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/section.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/table.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/subcanvas.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/image.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/styles.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/chart.bar.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/chart.line.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/axis.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/key.js' %}"></script>
    <script type='text/javascript' src="{% static 'griddl/js/components/arrow.js' %}"></script>
  {% endcomment %}
  
  {% javascript 'stats' %}
  
  <script src='http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML'></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
	
	/* http://docs.mathjax.org/en/latest/options/hub.html */
	
	tex2jax: {
		inlineMath: [["$","$"],["\\(","\\)"]]
	} ,
	
	jax : [ 'input/TeX' , 'output/HTML-CSS' ] ,
	//jax : [ 'input/TeX' , 'output/SVG' ] ,
	//jax : [ 'input/TeX' , 'output/NativeMML' ] ,
	
	messageStyle : 'none' ,
	
	/* Normally MathJax will typeset the mathematics on the page as soon as the page is loaded. If you want to delay that process, in which case you will need to call MathJax.Hub.Typeset() yourself by hand, set this value to true. */
	skipStartupTypeset : true ,
	
	/* This is a list of DOM element ID’s that are the ones to process for mathematics when any of the Hub typesetting calls (Typeset(), Process(), Update(), etc.) are called with no element specified, and during MathJax’s initial typesetting run when it starts up. This lets you restrict the processing to particular containers rather than scanning the entire document for mathematics. If none are supplied, the complete document is processed. */
	elements : [] ,
	
	showMathMenu : true ,
	showMathMenuMSIE : true
});
</script>
  
</head>
<body class="framed">
  <div class="container-fluid"> 
    <div class="header"></div>
 
    <div class="row" id="documentMenu">
      <div class="col-sm-6">


        <div style="display: inline-block;">
          {% if user.is_authenticated and user.account == workbook.owner %}
            <a id="up" style="margin-right:1em;" class="btn btn-default" href="{{ parentdir }}">
              <i class="fa fa-level-up fa-flip-horizontal fa-lg" style="vertical-align: middle;"></i>
              Up
            </a>
          {% endif %}
          <h4 id="workbookName" style="margin-right:1em;">{{ workbook.name }}</h4>
        </div>


        <div class="btn-group">
          <button class="btn btn-default dropdown-toggle" data-toggle='dropdown' aria-haspopup="true" aria-expanded="false">
            <i class="fa fa-cube fa-lg"></i>
            Add<span class="hidden-xs"> Component</span>
            <span class="caret"></span>
          </button>
            <ul class="dropdown-menu">
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['data']());">
                  Data
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['js'](null, 'js'));">
                  Javascript
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['md'](null, 'md'));">
                  Markdown
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['html'](null, 'html'));">
                  Html
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['css'](null, 'css'));">
                  Css
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['txt'](null, 'txt'));">
                  Plain Text
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['file'](null, 'file'));">
                  File
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['jsfile'](null, 'jsfile'));">
                  Javascript File
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['imgfile'](null, 'imgfile'));">
                  Image File
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['repl'](null, 'repl'));">
                  Javascript REPL
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Components.NewComponent(new Hyperdeck.Components['snips'](null, 'snips'));">
                  Javascript Snippets
                </a>
              </li>
            </ul>
        </div>
        
        <div class="btn-group">
          <button class="btn btn-default dropdown-toggle" data-toggle='dropdown' aria-haspopup="true" aria-expanded="false">
            <i class="fa fa-wrench fa-lg"></i>
            Tools
            <span class="caret"></span>
          </button>
            <ul class="dropdown-menu">
              <li>
                <a onclick="Hyperdeck.Export()">
                  Export
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.Import()">
                  Import
                </a>
              </li>
              <li>
                <a onclick="Hyperdeck.ShowPasswordInput()">
                  Encrypt
                </a>
              </li>
            </ul>
        </div>
        
      </div>

      <div class="col-sm-6">
              
        <div class="btn-group btn-group" role="tablist" id="ui-toggle">
          <button class="btn btn-default" id="show-components" title="View Components">
            <i class="fa fa-cubes fa-lg"></i>
            <span class="hidden-xs hidden-sm">Components</span>
          </button>
          <button class="btn btn-default active" id="show-all" title="View Split Screen">
            <i class="fa fa-columns fa-lg"></i>
            <span class="hidden-xs hidden-sm">Split</span>
          </button>
          <button class="btn btn-default" id="show-widgets" title="View Document">
            <i class="fa fa-file-text-o fa-lg"></i>
            <span class="hidden-xs hidden-sm">Document</span>
          </button>
        </div>

        <div class="pull-right">
          {% if user.is_authenticated and user.account == workbook.owner %}
            <button class="btn btn-default" id="saveMenuButton">
              <i class="fa fa-save fa-lg"></i>
              Save
            </button>
          {% endif %}
          <button class="btn btn-default" id="saveasMenuButton" data-toggle="modal" data-target='#saveAsModal'>
            <i class="fa fa-files-o fa-lg"></i>
            Save As
          </button>
        </div>

      </div>
    </div>

    <input type="file" id="fileChooser" style="display:none" />

    <div class="row tab-content">
      <div class="col-sm-6" id='cells-container'>

        <div id="frce"></div>

        <div role="tabpanel" class="active" id='cells'></div>
      </div>
      <div class="col-sm-6" id='output-container'>
        <div role="tabpanel" class="active" id='output'>
          <!-- <label class="griddl-component-head-type">Output</label> -->
        </div>
      </div>
    </div>
  </div>


  <div id="saveAsModal" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <form class='form-horizontal' id="saveAsForm">
            {% csrf_token %}
            <input type="hidden" name="id" value="{{ workbook.pk }}"></input>
            <input id="saveAsFormTextInput" type="hidden" name="text" value=""></input>
            <div class="form-group">
              <label class='col-sm-3 form-label'>New name:</label>
              <div class='col-sm-9'>
                <input class="form-control" type="text" name="newname"></input>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button id="saveAsSubmit" class="btn btn-success" type="submit" value="Save">Save</input>
          <button class="btn btn-danger" type="button" value="Cancel" data-dismiss="modal">Cancel</input>
        </div>
      </div>
    </div>
  </div>
  
  <div id="passwordModal" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <input id="passwordInput" type="password" name="text" value=""></input>
        </div>
        <div class="modal-footer">
          <button class="btn btn-success" value="Save" onclick="Hyperdeck.SetPassword()">Save</input>
          <button class="btn btn-danger" type="button" value="Cancel" data-dismiss="modal">Cancel</input>
        </div>
      </div>
    </div>
  </div>

</body>
